-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://github.com/pgadmin-org/pgadmin4/issues/new/choose if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS public."Students"
(
    "Id" integer NOT NULL,
    name character varying(100),
    subject_1 character varying(75),
    subject_2 character varying(75),
    subject_3 character varying(75),
    "group" integer NOT NULL,
    PRIMARY KEY ("Id"),
    CONSTRAINT special UNIQUE ("Id")
);

CREATE TABLE IF NOT EXISTS public.subjects
(
    id integer NOT NULL,
    name character varying NOT NULL,
    PRIMARY KEY (name),
    CONSTRAINT "i++" UNIQUE (id)
);

CREATE TABLE IF NOT EXISTS public.marks
(
    student_id integer NOT NULL,
    student_name character varying(100),
    subject_name character varying(75),
    score integer NOT NULL,
    "Teacher" character varying(100)
);

CREATE TABLE IF NOT EXISTS public."Teachers"
(
    id integer NOT NULL,
    name character varying(100) NOT NULL,
    subject character varying(75) NOT NULL,
    PRIMARY KEY (name),
    CONSTRAINT "1" UNIQUE (id)
);

CREATE TABLE IF NOT EXISTS public.examinations
(
    id integer NOT NULL,
    subject character varying(75) NOT NULL,
    teacher character varying(100),
    "group" integer NOT NULL,
    status character varying(25),
    date date NOT NULL,
    PRIMARY KEY (id),
    CONSTRAINT "1" UNIQUE (id)
);

CREATE TABLE IF NOT EXISTS public.groups
(
    group_id integer NOT NULL,
    group_name character varying(50) NOT NULL,
    PRIMARY KEY (group_id)
);

ALTER TABLE IF EXISTS public."Students"
    ADD CONSTRAINT "2" FOREIGN KEY (subject_1, subject_2, subject_3)
    REFERENCES public.subjects (name, name, name) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public."Students"
    ADD CONSTRAINT "3" FOREIGN KEY ("group")
    REFERENCES public.groups (group_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.marks
    ADD CONSTRAINT "1" FOREIGN KEY (student_id, student_name, subject_id, subject_name)
    REFERENCES public."Students" ("Id", name, id, name) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.marks
    ADD CONSTRAINT "2" FOREIGN KEY ("Teacher")
    REFERENCES public."Teachers" (name) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.marks
    ADD CONSTRAINT "3" FOREIGN KEY (subject_name)
    REFERENCES public.subjects (name) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.marks
    ADD CONSTRAINT "4" FOREIGN KEY (student_name)
    REFERENCES public."Students" (name) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public."Teachers"
    ADD CONSTRAINT "1" FOREIGN KEY (subject)
    REFERENCES public.subjects (name) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.examinations
    ADD CONSTRAINT "1" FOREIGN KEY (subject)
    REFERENCES public.subjects (name) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.examinations
    ADD CONSTRAINT "2" FOREIGN KEY (teacher)
    REFERENCES public."Teachers" (name) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public.examinations
    ADD CONSTRAINT "3" FOREIGN KEY ("group")
    REFERENCES public.groups (group_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;

END;
